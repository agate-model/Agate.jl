podman run --rm --device=nvidia.com/gpu=all -v $(pwd):/scripts -w /scripts localhost/for_loops-container julia paper/GPU/box_N2P2ZD_manual_adapt_vectorized.jl

==========
== CUDA ==
==========

CUDA Version 12.2

Container image Copyright (c) 2016-2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

A copy of this license is made available in this container at /NGC-DL-CONTAINER-LICENSE for your convenience.

┌ Warning: It's not recommended to use allowscalar([true]) to allow scalar indexing.
│ Instead, use `allowscalar() do end` or `@allowscalar` to denote exactly which operations can use scalar operations.
└ @ GPUArraysCore ~/.julia/packages/GPUArraysCore/aNaXo/src/GPUArraysCore.jl:184
[ Info: Initializing simulation...
ERROR: LoadError: GPU compilation of MethodInstance for (::GPUArrays.var"#gpu_broadcast_kernel_linear#38")(::KernelAbstractions.CompilerMetadata{KernelAbstractions.NDIteration.DynamicSize, KernelAbstractions.NDIteration.DynamicCheck, Nothing, CartesianIndices{1, Tuple{Base.OneTo{Int64}}}, KernelAbstractions.NDIteration.NDRange{1, KernelAbstractions.NDIteration.DynamicSize, KernelAbstractions.NDIteration.DynamicSize, CartesianIndices{1, Tuple{Base.OneTo{Int64}}}, CartesianIndices{1, Tuple{Base.OneTo{Int64}}}}}, ::CuDeviceVector{Float64, 1}, ::Base.Broadcast.Broadcasted{CUDA.CuArrayStyle{1, CUDA.DeviceMemory}, Tuple{Base.OneTo{Int64}}, typeof(Agate.Library.Mortality.linear_loss), Tuple{Base.Broadcast.Extruded{Vector{Float64}, Tuple{Bool}, Tuple{Int64}}, Base.Broadcast.Extruded{CuDeviceVector{Float64, 1}, Tuple{Bool}, Tuple{Int64}}}}) failed
KernelError: passing non-bitstype argument

Argument 4 to your kernel function is of type Base.Broadcast.Broadcasted{CUDA.CuArrayStyle{1, CUDA.DeviceMemory}, Tuple{Base.OneTo{Int64}}, typeof(Agate.Library.Mortality.linear_loss), Tuple{Base.Broadcast.Extruded{Vector{Float64}, Tuple{Bool}, Tuple{Int64}}, Base.Broadcast.Extruded{CuDeviceVector{Float64, 1}, Tuple{Bool}, Tuple{Int64}}}}, which is not a bitstype:
  .args is of type Tuple{Base.Broadcast.Extruded{Vector{Float64}, Tuple{Bool}, Tuple{Int64}}, Base.Broadcast.Extruded{CuDeviceVector{Float64, 1}, Tuple{Bool}, Tuple{Int64}}} which is not isbits.
    .1 is of type Base.Broadcast.Extruded{Vector{Float64}, Tuple{Bool}, Tuple{Int64}} which is not isbits.
      .x is of type Vector{Float64} which is not isbits.
        .ref is of type MemoryRef{Float64} which is not isbits.
          .mem is of type Memory{Float64} which is not isbits.


Only bitstypes, which are "plain data" types that are immutable
and contain no references to other values, can be used in GPU kernels.
For more information, see the `Base.isbitstype` function.

Stacktrace:
  [1] check_invocation(job::GPUCompiler.CompilerJob)
    @ GPUCompiler ~/.julia/packages/GPUCompiler/2MI6e/src/validation.jl:108
  [2] compile_unhooked(output::Symbol, job::GPUCompiler.CompilerJob; kwargs::@Kwargs{})
    @ GPUCompiler ~/.julia/packages/GPUCompiler/2MI6e/src/driver.jl:85
  [3] compile_unhooked
    @ ~/.julia/packages/GPUCompiler/2MI6e/src/driver.jl:80 [inlined]
  [4] compile(target::Symbol, job::GPUCompiler.CompilerJob; kwargs::@Kwargs{})
    @ GPUCompiler ~/.julia/packages/GPUCompiler/2MI6e/src/driver.jl:67
  [5] compile
    @ ~/.julia/packages/GPUCompiler/2MI6e/src/driver.jl:55 [inlined]
  [6] #1171
    @ ~/.julia/packages/CUDA/TW8fL/src/compiler/compilation.jl:255 [inlined]
  [7] JuliaContext(f::CUDA.var"#1171#1174"{GPUCompiler.CompilerJob{GPUCompiler.PTXCompilerTarget, CUDA.CUDACompilerParams}}; kwargs::@Kwargs{})
    @ GPUCompiler ~/.julia/packages/GPUCompiler/2MI6e/src/driver.jl:34
  [8] JuliaContext(f::Function)
    @ GPUCompiler ~/.julia/packages/GPUCompiler/2MI6e/src/driver.jl:25
  [9] compile(job::GPUCompiler.CompilerJob)
    @ CUDA ~/.julia/packages/CUDA/TW8fL/src/compiler/compilation.jl:254
 [10] actual_compilation(cache::Dict{Any, CuFunction}, src::Core.MethodInstance, world::UInt64, cfg::GPUCompiler.CompilerConfig{GPUCompiler.PTXCompilerTarget, CUDA.CUDACompilerParams}, compiler::typeof(CUDA.compile), linker::typeof(CUDA.link))
    @ GPUCompiler ~/.julia/packages/GPUCompiler/2MI6e/src/execution.jl:245
 [11] cached_compilation(cache::Dict{Any, CuFunction}, src::Core.MethodInstance, cfg::GPUCompiler.CompilerConfig{GPUCompiler.PTXCompilerTarget, CUDA.CUDACompilerParams}, compiler::Function, linker::Function)
    @ GPUCompiler ~/.julia/packages/GPUCompiler/2MI6e/src/execution.jl:159
 [12] macro expansion
    @ ~/.julia/packages/CUDA/TW8fL/src/compiler/execution.jl:373 [inlined]
 [13] macro expansion
    @ ./lock.jl:273 [inlined]
 [14] cufunction(f::GPUArrays.var"#gpu_broadcast_kernel_linear#38", tt::Type{Tuple{KernelAbstractions.CompilerMetadata{KernelAbstractions.NDIteration.DynamicSize, KernelAbstractions.NDIteration.DynamicCheck, Nothing, CartesianIndices{1, Tuple{Base.OneTo{Int64}}}, KernelAbstractions.NDIteration.NDRange{1, KernelAbstractions.NDIteration.DynamicSize, KernelAbstractions.NDIteration.DynamicSize, CartesianIndices{1, Tuple{Base.OneTo{Int64}}}, CartesianIndices{1, Tuple{Base.OneTo{Int64}}}}}, CuDeviceVector{Float64, 1}, Base.Broadcast.Broadcasted{CUDA.CuArrayStyle{1, CUDA.DeviceMemory}, Tuple{Base.OneTo{Int64}}, typeof(Agate.Library.Mortality.linear_loss), Tuple{Base.Broadcast.Extruded{Vector{Float64}, Tuple{Bool}, Tuple{Int64}}, Base.Broadcast.Extruded{CuDeviceVector{Float64, 1}, Tuple{Bool}, Tuple{Int64}}}}}}; kwargs::@Kwargs{always_inline::Bool, maxthreads::Nothing})
    @ CUDA ~/.julia/packages/CUDA/TW8fL/src/compiler/execution.jl:368
 [15] macro expansion
    @ ~/.julia/packages/CUDA/TW8fL/src/compiler/execution.jl:112 [inlined]
 [16] (::KernelAbstractions.Kernel{CUDABackend, KernelAbstractions.NDIteration.DynamicSize, KernelAbstractions.NDIteration.DynamicSize, GPUArrays.var"#gpu_broadcast_kernel_linear#38"})(::CuArray{Float64, 1, CUDA.DeviceMemory}, ::Vararg{Any}; ndrange::Tuple{Int64}, workgroupsize::Nothing)
    @ CUDA.CUDAKernels ~/.julia/packages/CUDA/TW8fL/src/CUDAKernels.jl:103
 [17] _copyto!
    @ ~/.julia/packages/GPUArrays/uiVyU/src/host/broadcast.jl:71 [inlined]
 [18] copyto!
    @ ~/.julia/packages/GPUArrays/uiVyU/src/host/broadcast.jl:44 [inlined]
 [19] copy
    @ ~/.julia/packages/GPUArrays/uiVyU/src/host/broadcast.jl:29 [inlined]
 [20] materialize
    @ ./broadcast.jl:872 [inlined]
 [21] custom_net_linear_loss(P::Vector{Float64}, linear_mortality::CuArray{Float64, 1, CUDA.DeviceMemory}, fraction::Float64)
    @ Agate.Utils /scripts/paper/GPU/N2P2ZD/functions_vectorized.jl:140
 [22] (::Agate.Utils.var"915e61e0-15e6-11f0-3b18-b97f086fad21"{Float64, CuArray{Float64, 2, CUDA.DeviceMemory}, CuArray{Float64, 1, CUDA.DeviceMemory}})(::Val{:N}, x::Float64, y::Float64, z::Float64, t::Float64, N::Float64, Z2::Float64, D::Float64, P1::Float64, P2::Float64, Z1::Float64, PAR::Float64)
    @ Agate.Utils /opt/julia_env/src/Utils/Utils.jl:287
 [23] (::OceanBioME.ContinuousBiogeochemistry{Agate.Utils.var"915e61e0-15e6-11f0-3b18-b97f086fad21"{Float64, CuArray{Float64, 2, CUDA.DeviceMemory}, CuArray{Float64, 1, CUDA.DeviceMemory}}, FunctionFieldPAR, Nothing, Nothing, Nothing})(::Val{:N}, ::Vararg{Any})
    @ OceanBioME ~/.julia/packages/OceanBioME/F9a6R/src/OceanBioME.jl:149
 [24] tracer_tendency
    @ ~/.julia/packages/OceanBioME/F9a6R/src/BoxModel/timesteppers.jl:60 [inlined]
 [25] compute_tendencies!(model::BoxModel{RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, OceanBioME.ContinuousBiogeochemistry{Agate.Utils.var"915e61e0-15e6-11f0-3b18-b97f086fad21"{Float64, CuArray{Float64, 2, CUDA.DeviceMemory}, CuArray{Float64, 1, CUDA.DeviceMemory}}, FunctionFieldPAR, Nothing, Nothing, Nothing}, @NamedTuple{N::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, Z2::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, D::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, P1::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, P2::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, Z1::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}}, Vector{Float64}, @NamedTuple{N::typeof(OceanBioME.BoxModels.no_func), Z2::typeof(OceanBioME.BoxModels.no_func), D::typeof(OceanBioME.BoxModels.no_func), P1::typeof(OceanBioME.BoxModels.no_func), P2::typeof(OceanBioME.BoxModels.no_func), Z1::typeof(OceanBioME.BoxModels.no_func)}, Oceananigans.TimeSteppers.RungeKutta3TimeStepper{Float64, @NamedTuple{N::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, Z2::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, D::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, P1::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, P2::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, Z1::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}}, Nothing}, Clock{Float64, Float64}, @NamedTuple{}}, callbacks::Vector{Any})
    @ OceanBioME.BoxModels ~/.julia/packages/OceanBioME/F9a6R/src/BoxModel/timesteppers.jl:44
 [26] update_state!(model::BoxModel{RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, OceanBioME.ContinuousBiogeochemistry{Agate.Utils.var"915e61e0-15e6-11f0-3b18-b97f086fad21"{Float64, CuArray{Float64, 2, CUDA.DeviceMemory}, CuArray{Float64, 1, CUDA.DeviceMemory}}, FunctionFieldPAR, Nothing, Nothing, Nothing}, @NamedTuple{N::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, Z2::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, D::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, P1::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, P2::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, Z1::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}}, Vector{Float64}, @NamedTuple{N::typeof(OceanBioME.BoxModels.no_func), Z2::typeof(OceanBioME.BoxModels.no_func), D::typeof(OceanBioME.BoxModels.no_func), P1::typeof(OceanBioME.BoxModels.no_func), P2::typeof(OceanBioME.BoxModels.no_func), Z1::typeof(OceanBioME.BoxModels.no_func)}, Oceananigans.TimeSteppers.RungeKutta3TimeStepper{Float64, @NamedTuple{N::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, Z2::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, D::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, P1::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, P2::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, Z1::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}}, Nothing}, Clock{Float64, Float64}, @NamedTuple{}}, callbacks::Vector{Any}; compute_tendencies::Bool)
    @ OceanBioME.BoxModels ~/.julia/packages/OceanBioME/F9a6R/src/BoxModel/boxmodel.jl:101
 [27] update_state! (repeats 2 times)
    @ ~/.julia/packages/OceanBioME/F9a6R/src/BoxModel/boxmodel.jl:86 [inlined]
 [28] initialize!(sim::Simulation{BoxModel{RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, OceanBioME.ContinuousBiogeochemistry{Agate.Utils.var"915e61e0-15e6-11f0-3b18-b97f086fad21"{Float64, CuArray{Float64, 2, CUDA.DeviceMemory}, CuArray{Float64, 1, CUDA.DeviceMemory}}, FunctionFieldPAR, Nothing, Nothing, Nothing}, @NamedTuple{N::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, Z2::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, D::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, P1::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, P2::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, Z1::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}}, Vector{Float64}, @NamedTuple{N::typeof(OceanBioME.BoxModels.no_func), Z2::typeof(OceanBioME.BoxModels.no_func), D::typeof(OceanBioME.BoxModels.no_func), P1::typeof(OceanBioME.BoxModels.no_func), P2::typeof(OceanBioME.BoxModels.no_func), Z1::typeof(OceanBioME.BoxModels.no_func)}, Oceananigans.TimeSteppers.RungeKutta3TimeStepper{Float64, @NamedTuple{N::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, Z2::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, D::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, P1::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, P2::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, Z1::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}}, Nothing}, Clock{Float64, Float64}, @NamedTuple{}}, Float64, Float64, OrderedCollections.OrderedDict{Symbol, Oceananigans.AbstractDiagnostic}, OrderedCollections.OrderedDict{Symbol, Oceananigans.AbstractOutputWriter}, OrderedCollections.OrderedDict{Symbol, Callback}})
    @ Oceananigans.Simulations ~/.julia/packages/Oceananigans/p4IUv/src/Simulations/run.jl:191
 [29] time_step!(sim::Simulation{BoxModel{RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, OceanBioME.ContinuousBiogeochemistry{Agate.Utils.var"915e61e0-15e6-11f0-3b18-b97f086fad21"{Float64, CuArray{Float64, 2, CUDA.DeviceMemory}, CuArray{Float64, 1, CUDA.DeviceMemory}}, FunctionFieldPAR, Nothing, Nothing, Nothing}, @NamedTuple{N::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, Z2::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, D::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, P1::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, P2::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, Z1::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}}, Vector{Float64}, @NamedTuple{N::typeof(OceanBioME.BoxModels.no_func), Z2::typeof(OceanBioME.BoxModels.no_func), D::typeof(OceanBioME.BoxModels.no_func), P1::typeof(OceanBioME.BoxModels.no_func), P2::typeof(OceanBioME.BoxModels.no_func), Z1::typeof(OceanBioME.BoxModels.no_func)}, Oceananigans.TimeSteppers.RungeKutta3TimeStepper{Float64, @NamedTuple{N::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, Z2::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, D::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, P1::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, P2::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, Z1::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}}, Nothing}, Clock{Float64, Float64}, @NamedTuple{}}, Float64, Float64, OrderedCollections.OrderedDict{Symbol, Oceananigans.AbstractDiagnostic}, OrderedCollections.OrderedDict{Symbol, Oceananigans.AbstractOutputWriter}, OrderedCollections.OrderedDict{Symbol, Callback}})
    @ Oceananigans.Simulations ~/.julia/packages/Oceananigans/p4IUv/src/Simulations/run.jl:112
 [30] run!(sim::Simulation{BoxModel{RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, OceanBioME.ContinuousBiogeochemistry{Agate.Utils.var"915e61e0-15e6-11f0-3b18-b97f086fad21"{Float64, CuArray{Float64, 2, CUDA.DeviceMemory}, CuArray{Float64, 1, CUDA.DeviceMemory}}, FunctionFieldPAR, Nothing, Nothing, Nothing}, @NamedTuple{N::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, Z2::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, D::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, P1::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, P2::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, Z1::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}}, Vector{Float64}, @NamedTuple{N::typeof(OceanBioME.BoxModels.no_func), Z2::typeof(OceanBioME.BoxModels.no_func), D::typeof(OceanBioME.BoxModels.no_func), P1::typeof(OceanBioME.BoxModels.no_func), P2::typeof(OceanBioME.BoxModels.no_func), Z1::typeof(OceanBioME.BoxModels.no_func)}, Oceananigans.TimeSteppers.RungeKutta3TimeStepper{Float64, @NamedTuple{N::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, Z2::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, D::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, P1::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, P2::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, Z1::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}}, Nothing}, Clock{Float64, Float64}, @NamedTuple{}}, Float64, Float64, OrderedCollections.OrderedDict{Symbol, Oceananigans.AbstractDiagnostic}, OrderedCollections.OrderedDict{Symbol, Oceananigans.AbstractOutputWriter}, OrderedCollections.OrderedDict{Symbol, Callback}}; pickup::Bool)
    @ Oceananigans.Simulations ~/.julia/packages/Oceananigans/p4IUv/src/Simulations/run.jl:97
 [31] run!(sim::Simulation{BoxModel{RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, OceanBioME.ContinuousBiogeochemistry{Agate.Utils.var"915e61e0-15e6-11f0-3b18-b97f086fad21"{Float64, CuArray{Float64, 2, CUDA.DeviceMemory}, CuArray{Float64, 1, CUDA.DeviceMemory}}, FunctionFieldPAR, Nothing, Nothing, Nothing}, @NamedTuple{N::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, Z2::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, D::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, P1::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, P2::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, Z1::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}}, Vector{Float64}, @NamedTuple{N::typeof(OceanBioME.BoxModels.no_func), Z2::typeof(OceanBioME.BoxModels.no_func), D::typeof(OceanBioME.BoxModels.no_func), P1::typeof(OceanBioME.BoxModels.no_func), P2::typeof(OceanBioME.BoxModels.no_func), Z1::typeof(OceanBioME.BoxModels.no_func)}, Oceananigans.TimeSteppers.RungeKutta3TimeStepper{Float64, @NamedTuple{N::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, Z2::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, D::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, P1::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, P2::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}, Z1::Field{Center, Center, Center, Nothing, RectilinearGrid{Float64, Flat, Flat, Flat, Float64, Float64, Float64, Nothing, Nothing, Nothing, CPU}, Tuple{Colon, Colon, Colon}, OffsetArrays.OffsetArray{Float64, 3, Array{Float64, 3}}, Float64, FieldBoundaryConditions{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, BoundaryCondition{Oceananigans.BoundaryConditions.Flux, Nothing}}, Nothing, Oceananigans.Fields.FieldBoundaryBuffers{Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing}}}, Nothing}, Clock{Float64, Float64}, @NamedTuple{}}, Float64, Float64, OrderedCollections.OrderedDict{Symbol, Oceananigans.AbstractDiagnostic}, OrderedCollections.OrderedDict{Symbol, Oceananigans.AbstractOutputWriter}, OrderedCollections.OrderedDict{Symbol, Callback}})
    @ Oceananigans.Simulations ~/.julia/packages/Oceananigans/p4IUv/src/Simulations/run.jl:85
 [32] top-level scope
    @ /scripts/paper/GPU/box_N2P2ZD_manual_adapt_vectorized.jl:43
in expression starting at /scripts/paper/GPU/box_N2P2ZD_manual_adapt_vectorized.jl:43

